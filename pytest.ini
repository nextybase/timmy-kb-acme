[pytest]
minversion = 7.0
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
log_level = ERROR

# Per default escludiamo test che toccano GitHub/Drive (eseguiamo solo smoke locali).
addopts =
    -q
    -ra
    --strict-markers
    --maxfail=1
    --color=yes
    --durations=10
    -m "not push and not drive and not e2e"

# Marker ufficiali del progetto
markers =
    contract: test di contratto UI/gating
    e2e: test end-to-end UI con Playwright
    push: test che richiedono GITHUB_TOKEN e accesso a GitHub (inclusi con -m "push")
    drive: test che usano Google Drive (SERVICE_ACCOUNT_FILE/DRIVE_ID) (inclusi con -m "drive")
    slow: test lenti/end-to-end
    settings: test unit per il loader Settings
    pipeline: integrazione pipeline core
    ui: test superficie Streamlit/UI
    semantic: test modulo semantic
    regression_light: regressioni leggere su onboarding slug/Vision/Drive

# Logging leggibile in CI/locale
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s %(levelname)s %(name)s | %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Rumore da librerie terze
filterwarnings =
    error::EncodingWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning
